# Garcia-2024-CRDS-Interference
Data and analysis on investigatation of interference on CRDS instruments.

# Maintainer
Jesper Nørlem Kamp.
Contact information here: <https://au.dk/jk@bce>.

# Contributors
Pablo Garcia <https://au.dk/au615105@bce>

Anna Holm Støckler <https://au.dk/anna@bce>

Anders Feilberg <https://au.dk/af@bce>

Jesper Nørlem Kamp <https://au.dk/jk@bce>


# Submitted paper
The contents of this repo are presented in the following manuscript:

Garcia, P., Støckler, A. H., Feilberg, A., Kamp, J., N. Investigation of non-target gas interferences on a multi-gas cavity ring-down spectrometer. Submitted for Atmospheric Measurement Techniques.

# Overview
This repo contains all the data and data processing scripts needed to produce the results presented in the paper listed above.
The scripts run in R (<https://www.r-project.org/>) and require several add-on packages.

# Directory structure

## `H2O Interferences`
Measurement data and scripts on H2O interference.
Use scripts `H2O_Test1&2.R` and `H2O_Test3.R`.

## `NH3 Interferences`
Measurement data and scripts on NH3 interference.
Use scripts `Calibration_NH3.R` and `NH3_Interferences.R`.

## `VOC Interferences`
Measurement data and scripts on VOC interference.
Use scripts `PTRdata_Picarrodata_Timeallign_Example.R` and `VOC_Interferences.R`.

# Links to paper
This section give the sources of tables and figures presented in the paper.

**Figure 3** is generated with R scripts `H2O_Test1&2.R` and `H2O_Test3.R`. These scripts are used to read the raw data from the CRDS, select the stable intervals, and calculate the means and standard deviation. The plot is generated by merging means and standard deviations for NH3, N2O, and CH4 from both R scripts. First, `H2O_Test3.R` is run to create the data frame for Test 3, then, `H2O_Test1&2.R` is run to create the data frame for Tests 1 and 2, and the plots.

**Figure 4** is generated with R script `NH3_Interferences.R`. This script is used to read the raw data from the CRDS, select stable intervals, and calculate the means and standard deviation of N2O and NH3. The script `Calibration_NH3.R` is used to read the data for NH3 calibration up to 16ppm and the values of background N2O and CH4, which will be used to generate figure 4b and c. The full merged figure 4 is generated with `NH3_Interferences.R`

**Figure 5** is generated with R script `VOC_Interferences.R`. The scripts `VOC_TimeAllign_1.R`, `VOC_TimeAllign_2.R`, `VOC_TimeAllign_3.R`, `VOC_TimeAllign_4.R` are used to read CRDS data, PTR-TOF data, align time of PTR-TOF and each CRDS, calculate means and standard deviations.  

**Figure S1** is generated with `CRDS_Calibration_plots.R`. The excel file `Calibration.xlsx` is the input to create the plots. It is generated with the script `Calibration_NH3.R`, that is used to select stable intervals and calculate means and standard deviations 

**Figure S2** is generated with `MFC_Calibration.R`. The excel file `R_MFC_Cal.xlsx` is the input and it gives the calibration done in the lab for each mass flow controller 

**Figure S3** is generated with `H2O_Test1&2.R`. The full raw data given by each CRDS is used to generate the plots. The data frame for the Test 2 comes from running `H2O_Test3.R`. This generates the data frame for Test 3 that is later used in `H2O_Test1&2.R` to generate the plot. 

**Figure S4** is generated with `H2O_Test1&2.R`. The full raw data interval is selected for G2509 and G4301 data for all Tests. The original data, the detrended data, and the fitting line to the original data are generated in `H2O_Test1&2.R` for Test 1 and 2, and `H2O_Test3.R` for Test3. First run `H2O_Test3.R` and then `H2O_Test1&2.R` to generate the plots. 

**Figure S5** is generated with `NH3_Interferences.R` in the same way as Figure 4.

**Figure S6** is generated with `VOC_Interferences.R` in the same way as Figure 5.
